/**
 * 不能用单引号
 */

/* 阶段充值玩家 */
select "%(sid)s" as `服务器ID`,v.player_id as `玩家账ID`,player_name as `账号`,player_fullname as `女儿名字`,sum(`order_coins`) as `充值总金币`,sum(`order_amount`) as `充值总人民币`,min(`vouch_date`) as `本阶段首次充值时间` from t_vouch v left join t_player p on v.player_id=p.player_id 
 where `vouch_date` between "2009-05-31 12:00:00" and "2009-08-05 00:00:00" group by v.player_id order by `充值总金币` desc 

/* 阶段消费玩家 */
select "%(sid)s" as `服务器ID`,c.player_id `玩家id`,player_name as `账号`,player_fullname as `女儿名字`,"%(sid)s" as `服务器ID`,sum(`cost`) as `消费金币` from t_consume c left join t_player p on c.player_id=p.player_id where `date` between "2009-10-22 00:00:00" and "2009-10-22 23:59:59" group by c.player_id order by `消费金币` desc 
/* 阶段物品消费 */
select "%(sid)s" as `服务器ID`,date(`date`) as `日期`,c.Goods_ID as `物品ID`,Goods_Name as `物品名字`,sum(`num`) as `销售数量`,sum(`cost`) as `销售金额` from t_consume c left join t_goods g on c.GOods_ID=g.Goods_ID where `date` between "2009-08-01 00:00:00" and "2009-08-24 00:00:00" group by date(`date`),c.Goods_ID order by `日期` asc,`销售数量` desc
/* 指定物品消费玩家 */
select "%(sid)s" as `服务器ID`,c.Player_ID as `玩家ID`,p.Player_Name as `账号`,p.Player_FullName as `女儿名字`,c.Goods_ID as `物品ID`,Goods_Name as `物品名字`,sum(`num`) as `数量`,sum(`cost`) as `消耗金币` from t_consume c left join t_goods g on c.GOods_ID=g.Goods_ID left join t_player p on c.Player_ID=p.Player_ID where (`date` between "2009-10-20 00:00:00" and "2009-10-20 23:59:59") and c.Goods_ID in (9347) group by p.Player_ID order by `数量` desc,`消耗金币` desc

/* 月城金卡剩余 */
select "%(sid)s" as `服务器ID`,sysdate() as `截止时间`,sum(Stuff_Stuffcount) as `月城金卡剩余数量` from t_daughter_stuff where stuff_stuffid=5511\G
/* 月城金卡销售 */
select "%(sid)s" as `服务器ID`,sysdate() as `截止时间`,sum(`num`) as `销售总量`,sum(`cost`) as `销售总金额` from t_consume where Goods_ID=5511\G
/* 金币 月币 礼金券 剩余 */
select "%(sid)s" as `服务器ID`,sysdate() as `截止时间`,sum(`Player_RMB`) as `金币`,sum(`Player_Salary`) as `月币`,sum(`Player_Silver`) as `礼金券` from t_player\G

/* 充值玩家总数 */
select "%(sid)s" as `服务器ID`,sysdate() as `截止时间`,count(distinct Player_ID) as `充值用户数量` from t_vouch where vouch_date between "2008-01-01 00:00:00" and "2020-01-01 00:00:00"\G

/* 阶段消费玩家 */
select "%(sid)s" as `服务器ID`,c.player_id `玩家id`,player_name as `账号`,player_fullname as `女儿名字`,"%(sid)s" as `服务器ID`,sum(`cost`) as `消费金币` from t_consume c left join t_player p on c.player_id=p.player_id where `date` between "2009-08-20 23:55:00" and "2009-08-25 00:05:00" group by c.player_id order by `消费金币` desc 
/* rsql */ select Player_Name as `账号`,Player_FullName as `女儿名字`,Player_lastloginip as `最后登陆IP`,sum(`cost`) as `累计消费金币总量` from t_consume as c left join t_player as p on c.Player_ID=p.Player_ID group by c.Player_ID order by `累计消费金币总量` desc limit 100

/* 原金币区月光宝盒 */
select sysdate() as `截止时间`,goods_id as `物品ID`,sum(stuff_stuffcount) as `物品名字`,goods_name as `物品名字`,goods_insert_name as `内部名字` from t_daughter_stuff d left join t_goods g on d.stuff_stuffid=g.goods_id where d.stuff_stuffid in (4605,4606,3596,3597,3598) group by d.stuff_stuffid

/* 充值总量 */
select sysdate() as `截止时间`,sum(order_coins) as `充值总金币`,sum(order_amount) as `充值总人民币`,count(distinct Player_ID) as `充值用户数`,sum(1) as `订单数` from t_vouch\G
/* 订单大小分布 */
select sysdate() as `截止时间`,order_coins as `金币`,order_amount as `人民币`,order_coins/order_amount as `汇率`,sum(1) as `次数`,sum(`order_coins`) as `总金币`,sum(`order_amount`) as `总人民币` from t_vouch group by `金币`,`汇率` order by `次数` desc limit 100
/* 玩家充值top100 */
select sysdate() as `截止时间`,v.Player_ID as `玩家ID`,Player_Name as `玩家账号`,Player_FullName as `女儿名字`,sum(order_coins) as `充值总金币`,sum(order_amount) as `充值总人民币`,sum(1) as `充值次数`,min(`vouch_date`) as `首次充值时间` from t_vouch v left join t_player p on v.Player_ID=p.Player_ID group by v.Player_ID order by `充值总金币` desc limit 100
/* 充值玩家 */
select sysdate() as `截止时间`,v.Player_ID as `玩家ID`,Player_Name as `玩家账号`,Player_FullName as `女儿名字`,sum(order_coins) as `充值总金币`,Player_lastlogintime as `最后登陆时间`,Daughter_Raise_Level as `养成等级`,Daughter_Level as `战斗等级` from t_vouch v left join t_player p on v.Player_ID=p.Player_ID left join t_daughter d on v.Player_ID=d.Player_ID group by v.Player_ID order by `充值总金币` desc
/*rsql*/select v.Player_ID,Player_Name,Player_FullName,sum(order_coins) as zong,Player_lastlogintime,Daughter_Raise_Level,Daughter_Level from t_vouch v left join t_player p on v.Player_ID=p.Player_ID left join t_daughter d on v.Player_ID=d.Player_ID group by v.Player_ID order by zong desc

/* 仅一次登陆玩家.激活即流失 */
select sysdate() as `截止时间`,sum(1) as `总玩家数`,sum(case Player_lastlogintime when "0000-00-00 00:00:00" then 1 when Player_RegisterTime then 1 else 0 end) as `仅一次登陆玩家`,sum(case Player_lastlogintime when "0000-00-00 00:00:00" then 1 when Player_RegisterTime then 1 else 0 end)/sum(1) as `一次性流失率` from t_player\G
/* 最近激活 */
select date(`Player_RegisterTime`) as `日期`,sum(1) as `激活人数` from t_player where Player_RegisterTime>="2009-09-10" group by date(`Player_RegisterTime`)
select sysdate() as `截止时间`,sum(1) as `激活人数` from t_player where Player_RegisterTime>="2009-09-10"\G

/* 商城道具消费 */
select date(`date`) as `日期`,c.Goods_ID as `物品ID`,Goods_Name as `物品名字`,sum(`num`) as `销售数量`,sum(`cost`) as `销售金额` from t_consume c left join t_goods g on c.GOods_ID=g.Goods_ID where `date` between "2009-08-01 00:00:00" and "2009-08-24 00:00:00" group by date(`date`),c.Goods_ID order by `日期` asc,`销售数量` desc
/* 单个物品消费 */
select sysdate() as `截止时间`,sum(`num`) as `销售数量`,sum(`cost`) as `销售金额` from t_consume where Goods_ID in (5510) and (`date` between "2009-03-24 00:00:00" and "2009-10-01") group by Goods_ID order by Goods_ID asc\G  

/* 指定玩家充值 */
select "%(sid)s" as `服务器ID`,sum(`order_coins`) as `金币`,sum(`order_amount`) as `人民币` from t_vouch where Player_ID=(select Player_ID from t_player where Player_Name="jionghaizi") and (vouch_date between "2009-08-01" and "2009-09-01")\G;
/* 指定玩家消费 */
select "%(sid)s" as `服务器ID`,c.Player_ID as `玩家ID`,p.Player_Name as `账号`,p.Player_FullName as `女儿名字`,c.Goods_ID as `物品ID`,Goods_Name as `物品名字`,sum(`num`) as `数量`,sum(`cost`) as `消耗金币` from t_consume c left join t_goods g on c.GOods_ID=g.Goods_ID left join t_player p on c.Player_ID=p.Player_ID where (`date` between "2009-10-21 00:00:00" and "2009-10-21 23:59:59") and c.Goods_ID in (9347) group by p.Player_ID order by `数量` desc,`消耗金币` desc

/* 背包物品数量 */
select stuff_stuffid as `物品ID`,stuff_stuffname as `物品名字`,sum(stuff_stuffcount) as `数量` from t_daughter_stuff where stuff_stuffid in (10612) group by stuff_stuffid
/* 背包有指定物品的玩家名单 */
select "%(sid)s" as `服务器ID`,stuff_playerid as `玩家ID`,Player_Name as `账号`,Player_FullName as `女儿名字`,stuff_stuffid as `物品ID`,stuff_stuffname as `物品名字`,sum(stuff_stuffcount) as `数量` from t_daughter_stuff left join t_player on stuff_playerid=player_id where stuff_stuffid in (10612) group by stuff_playerid,stuff_stuffid order by `数量` desc
/* 个人荣誉勋章数量名单 */
select Player_Name as `账号`,"%(sid)s" as `服务器ID`,sum(stuff_stuffcount) as `个人荣誉勋章数量` from t_daughter_stuff left join t_player on stuff_playerid=player_id where stuff_stuffid in (5193) and player_name in (
""
) group by stuff_playerid,stuff_stuffid order by player_name asc
/* 装备有指定 配饰 的玩家名单 */
select stuff_playerid as `玩家ID`,Player_Name as `账号`,Player_FullName as `女儿名字`,Goods_ID as `物品ID`,Goods_Name as `物品名字`,1 as `数量` from t_daughter_stuff_hold left join t_goods on Stuff_StuffID_O_1=Goods_ID left join t_player on stuff_playerid=player_id where Stuff_StuffID_O_1 in () group by stuff_playerid order by `数量` desc;select stuff_playerid as `玩家ID`,Goods_ID as `物品ID`,Goods_Name as `物品名字`,1 as `数量` from t_daughter_stuff_hold left join t_goods on Stuff_StuffID_O_2=Goods_ID where Stuff_StuffID_O_2 in () group by stuff_playerid order by `数量` desc;select stuff_playerid as `玩家ID`,Goods_ID as `物品ID`,Goods_Name as `物品名字`,1 as `数量` from t_daughter_stuff_hold left join t_goods on Stuff_StuffID_O_3=Goods_ID where Stuff_StuffID_O_3 in () group by stuff_playerid order by `数量` desc;select stuff_playerid as `玩家ID`,Goods_ID as `物品ID`,Goods_Name as `物品名字`,1 as `数量` from t_daughter_stuff_hold left join t_goods on Stuff_StuffID_O_4=Goods_ID where Stuff_StuffID_O_4 in () group by stuff_playerid order by `数量` desc
/* 穿了指定 养成衣服 的玩家名单 */
select stuff_playerid as `玩家ID`,Player_Name as `账号`,Player_FullName as `女儿名字`,Goods_ID as `物品ID`,Goods_Name as `物品名字`,1 as `数量` from t_daughter_stuff_hold left join t_goods on Stuff_StuffID_O_4=Goods_ID left join t_player on stuff_playerid=player_id where Stuff_StuffID_O_4 in () group by stuff_playerid order by `数量` desc
/* 吃过某卷轴的玩家数 */
select Scroll_Scroll_ID as `卷轴ID`,Goods_Name as `卷轴名字`,sum(1) as `数量` from t_scroll_list s left join t_goods g on s.Scroll_Scroll_ID=g.Goods_ID where Scroll_Scroll_ID in () group by Scroll_Scroll_ID
/* 吃过指定卷轴的玩家名单 */
select Scroll_PlayerID as `玩家ID`,Scroll_Scroll_ID as `卷轴ID`,Goods_Name as `卷轴名字` from t_scroll_list s left join t_goods g on s.Scroll_Scroll_ID=g.Goods_ID where Scroll_Scroll_ID in ()

/* sum_everyday */
select Sum_Date as `日期`,Player_RMB_Consume as `金币消耗`,Sum_Player_RMB as `金币剩余` from t_sum_everyday where Sum_Date between "2009-08-31" and "2009-09-31";

/* 亲和力top10-top10 */
select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 0,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 1,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 2,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 3,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 4,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 5,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 6,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 7,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 8,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;select sysdate() as `截止时间`,Rank_Daughter_Name as `被投票的女儿名字`,Rank_College_Name as `被投票的女儿所在学院`,Rank_Affinity as `被投票的女儿的亲和力`,Rank_Affinity_Rank as `被投票的女儿亲和力排名`,Vote_Name as `投票的女儿的名字`,Vote_Vote_Point as `投票数` from t_rank_daughter r left join t_vote_log v on r.Rank_Daughter_ID=v.Vote_To_Daughter where r.Rank_Daughter_ID=(select Rank_Daughter_ID from t_rank_daughter order by Rank_Affinity desc limit 9,1) order by r.Rank_Affinity desc,v.Vote_Vote_Point desc limit 10;
/* 亲和力top10 */
select sysdate() as `截止时间`,Player_ID as `玩家ID`,Rank_Daughter_Name as `女儿名字`,Rank_College_Name as `所在学院`,Rank_Affinity as `亲和力` from t_rank_daughter r left join t_daughter d on d.daughter_id=Rank_Daughter_ID order by r.Rank_Affinity desc limit 10

/* 怪叔叔 */
select player_name as `账号`,player_lastlogintime as `最后登录时间`,player_lastloginip as `最后登陆IP` from t_player where player_lastloginip="219.141.211.94"

/* 课程完成数量名单 */
select player_name as `账号`,player_fullname as `女儿名字`,sum(1) as `课程完成数量` from t_queue_finish left join t_player on Queue_Player_ID=player_id where queue_type>=119 and Queue_End_Time>='2009-09-17' group by queue_player_id

/* 学院战争胜利 */
select "%(sid)s" as `服务器ID`,date(Win_Time) as `胜利时间`,college_name as `学院名字` from t_robflag_result as b left join t_college as c on b.college_id=c.college_id where Win_Time between "2009-10-14" and "2009-10-25";

/* 婚嫁结局 */
select "%(sid)s" as `服务器ID`,p.Player_ID as `玩家ID`,Player_Name as `账号`,Player_fullname as `女儿名字`,b.Daughter_FinalID as `结局类型` from t_daughter_backup b left join t_player p on b.Player_ID=p.Player_ID left join t_daughter d on p.Player_ID=d.Player_ID where (d.Daughter_CreateTime between "2009-11-01 00:00:00" and "2009-11-10 23:59:59") order by b.Player_ID asc,b.Daughter_CreateTime desc

/* 领过某活动奖励的名单（活动有要求） */
select "%(sid)s" as `服务器ID`,p.Player_ID as `玩家ID`,Player_Name as `账号`,Player_fullname as `女儿名字`,Alog_aid as `活动ID`,Alog_Level as `活动等级` from t_activity_log alog left join t_player p on alog.Alog_Player_Name=p.Player_Name where alog.Alog_aid in (189) and (alog_date between "2009-11-14 19:43:00" and "2009-11-15 23:59:59")

/* top10学院-top30成员 */
select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 0,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 1,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 2,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 3,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 4,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 5,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 6,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 7,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 8,1) order by `综合属性` desc limit 30;select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_AbilityCharm`+`Daughter_BodyHeight`+`Daughter_BodyWeight`+`Daughter_BodyBreastSize`+`Daughter_BodyWaistSize`+`Daughter_BodyHipSize`+`Daughter_CharMorality`+`Daughter_CharLove`+`Daughter_CharChariness`+`Daughter_CharIndependence`+`Daughter_CharCalmness`+`Daughter_CharSelfRespect`+`Daughter_CharSociality`+`Daughter_CharCourage` as `综合属性` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where m.college_id=(select college_id from t_college order by College_Level desc limit 9,1) order by `综合属性` desc limit 30;
/* 部分学院top成员 */
select c.college_id as `学院id`,college_name as `学院名字`,p.player_id as `玩家id`,player_fullname as `女儿名字`,`Daughter_Raise_Level` as `养成等级` from t_daughter d left join t_player p on d.player_id=p.player_id left join t_college_member m on College_Player_ID=d.player_id left join t_college c on m.college_id=c.college_id where c.college_name in () group by c.college_id order by c.college_id desc,`养成等级` desc;

/* 阶段总消费 */
select "%(sid)s" as `服务器ID`,sum(`cost`) as `总消费金币` from t_consume where (`date` between "2009-12-04 00:00:00" and "2009-12-07 23:59:59")
/* 选票 */
select "%(sid)s" as `服务器ID`,stuff_playerid as `玩家ID`,Player_Name as `账号`,Player_FullName as `女儿名字`,stuff_stuffid as `物品ID`,stuff_stuffname as `物品名字`,sum(case stuff_stuffid when 9783 then stuff_stuffcount else 0 end) as `荣誉进攻选票数量`,sum(case stuff_stuffid when 9784 then stuff_stuffcount else 0 end) as `团结防守选票数量` from t_daughter_stuff left join t_player on stuff_playerid=player_id where stuff_stuffid in (9783,9784) group by stuff_playerid order by `荣誉进攻选票数量` desc,`团结防守选票数量` desc
/* 五项战斗属性总和 */
select Player_ID as `玩家ID`,`Daughter_AbilityPhysique`+`Daughter_AbilityVitality`+`Daughter_AbilityIntelligence`+`Daughter_AbilityMovement`+`Daughter_AbilitySpirit`+`Daughter_Perspective` as `总战斗属性` from t_daughter where Player_ID in () order by Player_ID asc


######################################################################
### shell
######################################################################
grep '购买物品.*id:\(9783\|9784\)' 2009-12-25-1[2-9]* 2009-12-25-2* 2009-12-2[6-9]-* 2009-12-30-* 2009-12-31-0* 2009-12-31-1[012]* | awk -F' | id:| 数量:' '{all[$4"\t"$5]=1;if ($8==9783) {gong[$4"\t"$5]+=$9;}else{fang[$4"\t"$5]+=$9;}}END{for (i in all){print i"\t"(gong[i]>0?gong[i]:0)"\t"(fang[i]>0?fang[i]:0);}}'

